/*
    main.me -- Main MakeMe File for the Updater
 */

Me.load({
    plugins: [ 'installs' ],

    settings: {
        prefixes: 'install-prefixes',
    },

    targets: {
        updater: {
            type: 'exe',
            includes: [ 'src', 'src/osdep', '/opt/homebrew/include' ],
            sources: [ 'src/updater.c', 'src/main.c' ],
            libpaths: [ '/opt/homebrew/lib' ],
            libraries: [ 'ssl', 'crypto' ],
            depends: [ ],
        },

        package: {
            depends: ['packagePak'],
        },

        packageSource: { },

        sync: {
            action: `sh('pak -f upgrade')`,
        },
    },

    manifest: {
        packages: {
            pak: {
                inherit:    'package-manifest',
                prefixes:   [ 'src' ],
                formats:    [ 'tar' ],
                sets:       [ 'pak' ],
            },
        },
        sets: { 
            pak: [
                {   
                    from:       [ 
                        'src/updater.h', 
                        'src/updater.c',  
                        'src/updater.js',  
                        'src/updater.sh',  
                        'src/apply.sh',  
                        'src/main.c',  
                        'src/me.h',  
                        'README.md',
                        'src/osdep/osdep.h',
                        'src/Makefile',
                    ],
                    to:  '${src}/dist/',
                }
            ]
        }
    }
})
